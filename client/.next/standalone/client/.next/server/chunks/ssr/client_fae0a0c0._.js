module.exports=[48047,a=>{"use strict";var b=a.i(9651),c=a.i(61199),d=a.i(21749),e=a.i(81545),f=a.i(81364),g=class extends e.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,f.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,f.hashKey)(b.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,c.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){d.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},h=a.i(56933);function i(a,c){let e=(0,h.useQueryClient)(c),[i]=b.useState(()=>new g(e,a));b.useEffect(()=>{i.setOptions(a)},[i,a]);let j=b.useSyncExternalStore(b.useCallback(a=>i.subscribe(d.notifyManager.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),k=b.useCallback((a,b)=>{i.mutate(a,b).catch(f.noop)},[i]);if(j.error&&(0,f.shouldThrowError)(i.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}a.s(["useMutation",()=>i],48047)},1929,29866,a=>{"use strict";var b=a.i(16547),c=a.i(9651),d=a.i(87564),e=a.i(81364);function f(a){return a}function g(a){return a.state.isPaused}function h(a){return"success"===a.state.status}function i(a){return!0}function j(a,b={}){let c=b.shouldDehydrateMutation??a.getDefaultOptions().dehydrate?.shouldDehydrateMutation??g,d=a.getMutationCache().getAll().flatMap(a=>c(a)?[{mutationKey:a.options.mutationKey,state:a.state,...a.options.scope&&{scope:a.options.scope},...a.meta&&{meta:a.meta}}]:[]),k=b.shouldDehydrateQuery??a.getDefaultOptions().dehydrate?.shouldDehydrateQuery??h,l=b.shouldRedactErrors??a.getDefaultOptions().dehydrate?.shouldRedactErrors??i,m=b.serializeData??a.getDefaultOptions().dehydrate?.serializeData??f;return{mutations:d,queries:a.getQueryCache().getAll().flatMap(a=>{let b;return k(a)?[{dehydratedAt:Date.now(),state:{...a.state,...void 0!==a.state.data&&{data:m(a.state.data)}},queryKey:a.queryKey,queryHash:a.queryHash,..."pending"===a.state.status&&{promise:(b=a.promise?.then(m).catch(a=>l(a)?Promise.reject(Error("redacted")):Promise.reject(a)),b?.catch(e.noop),b)},...a.meta&&{meta:a.meta}}]:[]})}}function k(a,b,c){if("object"!=typeof b||null===b)return;let g=a.getMutationCache(),h=a.getQueryCache(),i=c?.defaultOptions?.deserializeData??a.getDefaultOptions().hydrate?.deserializeData??f,j=b.mutations||[],k=b.queries||[];j.forEach(({state:b,...d})=>{g.build(a,{...a.getDefaultOptions().hydrate?.mutations,...c?.defaultOptions?.mutations,...d},b)}),k.forEach(({queryKey:b,state:f,queryHash:g,meta:j,promise:k,dehydratedAt:l})=>{let m=k?(0,d.tryResolveSync)(k):void 0,n=void 0===f.data?m?.data:f.data,o=void 0===n?n:i(n),p=h.get(g),q=p?.state.status==="pending",r=p?.state.fetchStatus==="fetching";if(p){let a=m&&void 0!==l&&l>p.state.dataUpdatedAt;if(f.dataUpdatedAt>p.state.dataUpdatedAt||a){let{fetchStatus:a,...b}=f;p.setState({...b,data:o})}}else p=h.build(a,{...a.getDefaultOptions().hydrate?.queries,...c?.defaultOptions?.queries,queryKey:b,queryHash:g,meta:j},{...f,data:o,fetchStatus:"idle",status:void 0!==o?"success":f.status});k&&!q&&!r&&(void 0===l||l>p.state.dataUpdatedAt)&&p.fetch(void 0,{initialPromise:Promise.resolve(k).then(i)}).catch(e.noop)})}a.s(["dehydrate",()=>j,"hydrate",()=>k],29866);var l=a.i(56933),m=({children:a,options:b={},state:d,queryClient:e})=>{let f=(0,l.useQueryClient)(e),g=c.useRef(b);c.useEffect(()=>{g.current=b});let h=c.useMemo(()=>{if(d){if("object"!=typeof d)return;let a=f.getQueryCache(),b=d.queries||[],c=[],e=[];for(let d of b){let b=a.get(d.queryHash);b?(d.state.dataUpdatedAt>b.state.dataUpdatedAt||d.promise&&"pending"!==b.state.status&&"fetching"!==b.state.fetchStatus&&void 0!==d.dehydratedAt&&d.dehydratedAt>b.state.dataUpdatedAt)&&e.push(d):c.push(d)}if(c.length>0&&k(f,{queries:c},g.current),e.length>0)return e}},[f,d]);return c.useEffect(()=>{h&&k(f,{queries:h},g.current)},[f,h]),a};function n(a){return(0,b.jsx)(m,{...a})}a.s(["Hydrate",()=>n],1929)},28373,a=>{"use strict";var b=a.i(16547),c=a.i(9651),d=a.i(91981);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-xl border border-gray-300 bg-card  dark:bg-navBackground  text-card-foreground shadow",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c}));j.displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardFooter",()=>j,"CardHeader",()=>f,"CardTitle",()=>g])},14305,a=>{"use strict";let b=(0,a.i(31276).default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);a.s(["Star",()=>b],14305)},30414,a=>{"use strict";var b=a.i(16547);a.i(9651);var c=a.i(95019),d=a.i(91981);let e=(0,c.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{className:(0,d.cn)(e({variant:c}),a),...f})}a.s(["Badge",()=>f])},21309,a=>{"use strict";let b=(0,a.i(31276).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],21309)},44718,a=>{"use strict";var b=a.i(16547),c=a.i(9651),d=a.i(54949),e=a.i(26332);a.s(["default",0,({children:a})=>{let f=(0,d.useRouter)(),g=(0,e.getUserIdFromToken)();return((0,c.useEffect)(()=>{g||f.push("/login")},[g,f]),g)?(0,b.jsx)(b.Fragment,{children:a}):null}])},67407,a=>{"use strict";let b=(0,a.i(31276).default)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);a.s(["default",()=>b])},79260,a=>{"use strict";var b=a.i(16547),c=a.i(30414),d=a.i(15723),e=a.i(28373),f=a.i(21309);let g=(0,a.i(31276).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var h=a.i(67407),h=h,i=a.i(14305),j=a.i(9651),k=a.i(54949),l=a.i(26332),m=a.i(44980);let n="https://lms-v4tz.onrender.com/course-progress",o=async(a,b)=>{try{let{data:c}=await m.default.get(`${n}/${a}/${b}`);return c.data}catch(a){console.error("Error fetching course:",a)}},p=async(a,b,c)=>{try{let{data:d}=await m.default.post(`${n}/${a}/${b}/${c}/view`);return d}catch(a){console.error("Error fetching course:",a)}},q=async(a,b)=>{try{let{data:c}=await m.default.post(`${n}/${a}/${b}/complete`);return c}catch(a){console.error("Error fetching course:",a)}},r=async(a,b)=>{try{let{data:c}=await m.default.post(`${n}/${a}/${b}/incomplete`);return c}catch(a){console.error("Error fetching course:",a)}};var s=a.i(48047),t=a.i(39197),u=a.i(56933);a.s(["default",0,()=>{let a,m,n,v;(0,k.useRouter)();let{courseId:w}=(0,k.useParams)();console.log("cousreidd??",w);let x=(0,l.getUserIdFromToken)(),{getCourseProgressQuery:y,markAsComplete:z,markAsInComplete:A,updateLectureProgress:B}=(a=(0,u.useQueryClient)(),m=(0,s.useMutation)({mutationFn:({courseId:a,userId:b,lectureId:c})=>p(a,b,c),onSuccess:b=>{a.invalidateQueries({queryKey:["course-progress"]})},onError:a=>{console.error("Error marking course as complete:",a)}}),n=(0,s.useMutation)({mutationFn:({courseId:a,userId:b})=>q(a,b),onSuccess:b=>{a.invalidateQueries({queryKey:["course-progress"]})},onError:a=>{console.error("Error marking course as complete:",a)}}),v=(0,s.useMutation)({mutationFn:({courseId:a,userId:b})=>r(a,b),onSuccess:b=>{a.invalidateQueries({queryKey:["course-progress"]})},onError:a=>{console.error("Error fetching course by ID:",a)}}),{markAsComplete:n.mutate,markAsInComplete:v.mutate,updateLectureProgress:m.mutate,getCourseProgressQuery:(a,b)=>(0,t.useQuery)({queryKey:["course-progress",a],queryFn:()=>o(a,b),enabled:!!a,onSuccess:a=>{},onError:a=>{console.error("Error fetching course by ID:",a)}})}),{data:C,isLoading:D,error:E}=y(w,x),[F,G]=(0,j.useState)(null),[H,I]=(0,j.useState)(0),[J,K]=(0,j.useState)(!1),[L,M]=(0,j.useState)(!1),[N,O]=(0,j.useState)(!1);(0,j.useEffect)(()=>{C&&G(C?.courseDetails.lectures[0])},[C]),(0,j.useEffect)(()=>{C&&C.completed&&!J?M(!0):M(!1)},[C,J]);let P=a=>{let b=C?.progress.find(b=>b.lectureId===a);return!!b&&b.viewed},Q=async a=>{try{if(!x)throw Error("User is not authenticated");if(!(await fetch("https://lms-v4tz.onrender.com/ratings/rating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:a,userId:x,courseId:w})})).ok)throw Error("Failed to rate course");K(!0)}catch(a){console.error(a)}},R=async()=>{try{O(!0);let a=await fetch("https://lms-v4tz.onrender.com/certificate/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:x,courseId:w,course:C?.courseDetails.courseTitle})});if(!a.ok)throw Error("Failed to generate certificate");let b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`Certificate-${C?.courseDetails.courseTitle}.pdf`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d)}catch(a){console.error("Error generating certificate:",a),alert("Failed to generate certificate. Please try again.")}finally{O(!1)}};return C?(0,b.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-blue-500",children:C?.courseDetails.courseTitle}),(0,b.jsxs)("div",{className:"flex gap-2",children:[C?.completed&&(0,b.jsx)(d.Button,{onClick:R,disabled:N,variant:"outline",className:"border-blue-500 text-blue-600 hover:bg-blue-50",children:N?"Generating...":"Generate Certificate"}),(0,b.jsx)(d.Button,{onClick:C?.completed?()=>{A({courseId:w,userId:x})}:()=>{z({courseId:w,userId:x})},variant:C?.completed?"outline":"default",children:C?.completed?(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(f.CheckCircle,{className:"h-4 w-4 mr-2"})," ",(0,b.jsx)("span",{children:"Mark as InComplete"})," "]}):"Mark as completed"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,b.jsxs)("div",{className:"flex-1 md:w-3/5 h-fit rounded-lg shadow-lg p-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)("video",{src:F?.videoUrl,controls:!0,className:"w-full h-auto md:rounded-lg"})}),(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("h3",{className:"font-medium text-lg",children:`Lecture ${C?.courseDetails.lectures.findIndex(a=>a._id===F?._id)+1} : ${F?.lectureTitle}`}),!P(F?._id)&&(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{B({courseId:w,userId:x,lectureId:F._id})},children:"Mark lecture as complete"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col w-full mb-10 h-[490px] md:w-2/5 border-t md:border-t-0 md:border-l border-gray-400 md:pl-4 pt-4 md:pt-0",children:[(0,b.jsx)("h2",{className:"font-semibold text-xl mb-4 text-blue-500",children:"Course Content"}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:C?.courseDetails.lectures.map(a=>(0,b.jsx)(e.Card,{className:`mb-3 hover:cursor-pointer transition transform ${a._id===F?._id?"bg-gray-200 dark:bg-gray-800":""} `,onClick:()=>{G(a)},children:(0,b.jsxs)(e.CardContent,{className:"flex items-center justify-between p-4",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[P(a._id)?(0,b.jsx)(g,{size:24,className:"text-green-500 mr-2"}):(0,b.jsx)(h.default,{size:24,className:"text-gray-500 mr-2"}),(0,b.jsx)("div",{children:(0,b.jsx)(e.CardTitle,{className:"text-lg font-medium",children:a.lectureTitle})})]}),P(a._id)&&(0,b.jsx)(c.Badge,{variant:"outline",className:"bg-green-200 text-green-600",children:"Completed"})]})},a._id))})]})]}),L&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,b.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-80",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Rate this course"}),(0,b.jsx)("div",{className:"flex justify-center items-center space-x-2",children:[1,2,3,4,5].map(a=>(0,b.jsx)(i.Star,{onClick:()=>I(a),className:`cursor-pointer h-8 w-8 ${H>=a?"text-yellow-500 fill-current":"text-gray-300"}`},a))}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(d.Button,{onClick:()=>Q(H),className:"mt-4  w-full",children:"Submit Rating"}),(0,b.jsx)(d.Button,{onClick:()=>{M(!1),I(0)},variant:"outline",className:"mt-4 w-full",children:"Cancel"})]})]})})]}):(0,b.jsx)("p",{children:"Course not found"})}],79260)}];

//# sourceMappingURL=client_fae0a0c0._.js.map