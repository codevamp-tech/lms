(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,17548,e=>{"use strict";var t=e.i(10977),r=e.i(72721),s=e.i(95349),a=e.i(39314),i=e.i(20215),o=class extends a.Subscribable{#e;#t=void 0;#r;#s;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#a(),this.#i()}mutate(e,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#a(){let e=this.#r?.state??(0,r.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){s.notifyManager.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#s.onSuccess?.(e.data,t,r,s),this.#s.onSettled?.(e.data,null,t,r,s)):e?.type==="error"&&(this.#s.onError?.(e.error,t,r,s),this.#s.onSettled?.(void 0,e.error,t,r,s))}this.listeners.forEach(e=>{e(this.#t)})})}},n=e.i(36109);function l(e,r){let a=(0,n.useQueryClient)(r),[l]=t.useState(()=>new o(a,e));t.useEffect(()=>{l.setOptions(e)},[l,e]);let c=t.useSyncExternalStore(t.useCallback(e=>l.subscribe(s.notifyManager.batchCalls(e)),[l]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),u=t.useCallback((e,t)=>{l.mutate(e,t).catch(i.noop)},[l]);if(c.error&&(0,i.shouldThrowError)(l.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:u,mutateAsync:c.mutate}}e.s(["useMutation",()=>l],17548)},93656,72232,e=>{"use strict";var t=e.i(66497),r=e.i(10977);e.i(93677);var s=e.i(28261),a=e.i(20215);function i(e){return e}function o(e){return e.state.isPaused}function n(e){return"success"===e.state.status}function l(e){return!0}function c(e,t={}){let r=t.shouldDehydrateMutation??e.getDefaultOptions().dehydrate?.shouldDehydrateMutation??o,s=e.getMutationCache().getAll().flatMap(e=>r(e)?[{mutationKey:e.options.mutationKey,state:e.state,...e.options.scope&&{scope:e.options.scope},...e.meta&&{meta:e.meta}}]:[]),u=t.shouldDehydrateQuery??e.getDefaultOptions().dehydrate?.shouldDehydrateQuery??n,d=t.shouldRedactErrors??e.getDefaultOptions().dehydrate?.shouldRedactErrors??l,h=t.serializeData??e.getDefaultOptions().dehydrate?.serializeData??i;return{mutations:s,queries:e.getQueryCache().getAll().flatMap(e=>{let t;return u(e)?[{dehydratedAt:Date.now(),state:{...e.state,...void 0!==e.state.data&&{data:h(e.state.data)}},queryKey:e.queryKey,queryHash:e.queryHash,..."pending"===e.state.status&&{promise:(t=e.promise?.then(h).catch(e=>d(e)?Promise.reject(Error("redacted")):Promise.reject(e)),t?.catch(a.noop),t)},...e.meta&&{meta:e.meta}}]:[]})}}function u(e,t,r){if("object"!=typeof t||null===t)return;let o=e.getMutationCache(),n=e.getQueryCache(),l=r?.defaultOptions?.deserializeData??e.getDefaultOptions().hydrate?.deserializeData??i,c=t.mutations||[],u=t.queries||[];c.forEach(({state:t,...s})=>{o.build(e,{...e.getDefaultOptions().hydrate?.mutations,...r?.defaultOptions?.mutations,...s},t)}),u.forEach(({queryKey:t,state:i,queryHash:o,meta:c,promise:u,dehydratedAt:d})=>{let h=u?(0,s.tryResolveSync)(u):void 0,m=void 0===i.data?h?.data:i.data,f=void 0===m?m:l(m),p=n.get(o),y=p?.state.status==="pending",g=p?.state.fetchStatus==="fetching";if(p){let e=h&&void 0!==d&&d>p.state.dataUpdatedAt;if(i.dataUpdatedAt>p.state.dataUpdatedAt||e){let{fetchStatus:e,...t}=i;p.setState({...t,data:f})}}else p=n.build(e,{...e.getDefaultOptions().hydrate?.queries,...r?.defaultOptions?.queries,queryKey:t,queryHash:o,meta:c},{...i,data:f,fetchStatus:"idle",status:void 0!==f?"success":i.status});u&&!y&&!g&&(void 0===d||d>p.state.dataUpdatedAt)&&p.fetch(void 0,{initialPromise:Promise.resolve(u).then(l)}).catch(a.noop)})}e.s(["dehydrate",()=>c,"hydrate",()=>u],72232);var d=e.i(36109),h=({children:e,options:t={},state:s,queryClient:a})=>{let i=(0,d.useQueryClient)(a),o=r.useRef(t);r.useEffect(()=>{o.current=t});let n=r.useMemo(()=>{if(s){if("object"!=typeof s)return;let e=i.getQueryCache(),t=s.queries||[],r=[],a=[];for(let s of t){let t=e.get(s.queryHash);t?(s.state.dataUpdatedAt>t.state.dataUpdatedAt||s.promise&&"pending"!==t.state.status&&"fetching"!==t.state.fetchStatus&&void 0!==s.dehydratedAt&&s.dehydratedAt>t.state.dataUpdatedAt)&&a.push(s):r.push(s)}if(r.length>0&&u(i,{queries:r},o.current),a.length>0)return a}},[i,s]);return r.useEffect(()=>{n&&u(i,{queries:n},o.current)},[i,n]),e};function m(e){return(0,t.jsx)(h,{...e})}e.s(["Hydrate",()=>m],93656)},30618,e=>{"use strict";var t=e.i(66497),r=e.i(10977),s=e.i(99681);let a=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("rounded-xl border border-gray-300 bg-card  dark:bg-navBackground  text-card-foreground shadow",e),...r}));a.displayName="Card";let i=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let o=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("font-semibold leading-none tracking-tight",e),...r}));o.displayName="CardTitle";let n=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("text-sm text-muted-foreground",e),...r}));n.displayName="CardDescription";let l=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("p-6 pt-0",e),...r}));l.displayName="CardContent";let c=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("flex items-center p-6 pt-0",e),...r}));c.displayName="CardFooter",e.s(["Card",()=>a,"CardContent",()=>l,"CardDescription",()=>n,"CardFooter",()=>c,"CardHeader",()=>i,"CardTitle",()=>o])},52593,e=>{"use strict";let t=(0,e.i(43184).default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],52593)},16255,e=>{"use strict";var t=e.i(66497);e.i(10977);var r=e.i(47418),s=e.i(99681);let a=(0,r.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:r,...i}){return(0,t.jsx)("div",{className:(0,s.cn)(a({variant:r}),e),...i})}e.s(["Badge",()=>i])},86e3,e=>{"use strict";let t=(0,e.i(43184).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],86e3)},10075,e=>{"use strict";var t=e.i(66497),r=e.i(10977),s=e.i(3139),a=e.i(95818);e.s(["default",0,({children:e})=>{let i=(0,s.useRouter)(),o=(0,a.getUserIdFromToken)();return((0,r.useEffect)(()=>{o||i.push("/login")},[o,i]),o)?(0,t.jsx)(t.Fragment,{children:e}):null}])},91440,e=>{"use strict";let t=(0,e.i(43184).default)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);e.s(["default",()=>t])},39282,e=>{"use strict";e.i(93677);var t=e.i(66497),r=e.i(16255),s=e.i(57445),a=e.i(30618),i=e.i(86e3);let o=(0,e.i(43184).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var n=e.i(91440),n=n,l=e.i(52593),c=e.i(10977),u=e.i(3139),d=e.i(95818),h=e.i(44506);let m="https://lms-v4tz.onrender.com/course-progress",f=async(e,t)=>{try{let{data:r}=await h.default.get(`${m}/${e}/${t}`);return r.data}catch(e){console.error("Error fetching course:",e)}},p=async(e,t,r)=>{try{let{data:s}=await h.default.post(`${m}/${e}/${t}/${r}/view`);return s}catch(e){console.error("Error fetching course:",e)}},y=async(e,t)=>{try{let{data:r}=await h.default.post(`${m}/${e}/${t}/complete`);return r}catch(e){console.error("Error fetching course:",e)}},g=async(e,t)=>{try{let{data:r}=await h.default.post(`${m}/${e}/${t}/incomplete`);return r}catch(e){console.error("Error fetching course:",e)}};var x=e.i(17548),v=e.i(49675),b=e.i(36109);e.s(["default",0,()=>{let e,h,m,C;(0,u.useRouter)();let{courseId:j}=(0,u.useParams)();console.log("cousreidd??",j);let w=(0,d.getUserIdFromToken)(),{getCourseProgressQuery:N,markAsComplete:k,markAsInComplete:O,updateLectureProgress:M}=(e=(0,b.useQueryClient)(),h=(0,x.useMutation)({mutationFn:({courseId:e,userId:t,lectureId:r})=>p(e,t,r),onSuccess:t=>{e.invalidateQueries({queryKey:["course-progress"]})},onError:e=>{console.error("Error marking course as complete:",e)}}),m=(0,x.useMutation)({mutationFn:({courseId:e,userId:t})=>y(e,t),onSuccess:t=>{e.invalidateQueries({queryKey:["course-progress"]})},onError:e=>{console.error("Error marking course as complete:",e)}}),C=(0,x.useMutation)({mutationFn:({courseId:e,userId:t})=>g(e,t),onSuccess:t=>{e.invalidateQueries({queryKey:["course-progress"]})},onError:e=>{console.error("Error fetching course by ID:",e)}}),{markAsComplete:m.mutate,markAsInComplete:C.mutate,updateLectureProgress:h.mutate,getCourseProgressQuery:(e,t)=>(0,v.useQuery)({queryKey:["course-progress",e],queryFn:()=>f(e,t),enabled:!!e,onSuccess:e=>{},onError:e=>{console.error("Error fetching course by ID:",e)}})}),{data:E,isLoading:R,error:S}=N(j,w),[D,U]=(0,c.useState)(null),[T,q]=(0,c.useState)(0),[A,K]=(0,c.useState)(!1),[$,P]=(0,c.useState)(!1),[z,Q]=(0,c.useState)(!1);(0,c.useEffect)(()=>{E&&U(E?.courseDetails.lectures[0])},[E]),(0,c.useEffect)(()=>{E&&E.completed&&!A?P(!0):P(!1)},[E,A]);let F=e=>{let t=E?.progress.find(t=>t.lectureId===e);return!!t&&t.viewed},B=async e=>{try{if(!w)throw Error("User is not authenticated");if(!(await fetch("https://lms-v4tz.onrender.com/ratings/rating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:e,userId:w,courseId:j})})).ok)throw Error("Failed to rate course");K(!0)}catch(e){console.error(e)}},L=async()=>{try{Q(!0);let e=await fetch("https://lms-v4tz.onrender.com/certificate/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:w,courseId:j,course:E?.courseDetails.courseTitle})});if(!e.ok)throw Error("Failed to generate certificate");let t=await e.blob(),r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=`Certificate-${E?.courseDetails.courseTitle}.pdf`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s)}catch(e){console.error("Error generating certificate:",e),alert("Failed to generate certificate. Please try again.")}finally{Q(!1)}};return E?(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-blue-500",children:E?.courseDetails.courseTitle}),(0,t.jsxs)("div",{className:"flex gap-2",children:[E?.completed&&(0,t.jsx)(s.Button,{onClick:L,disabled:z,variant:"outline",className:"border-blue-500 text-blue-600 hover:bg-blue-50",children:z?"Generating...":"Generate Certificate"}),(0,t.jsx)(s.Button,{onClick:E?.completed?()=>{O({courseId:j,userId:w})}:()=>{k({courseId:j,userId:w})},variant:E?.completed?"outline":"default",children:E?.completed?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i.CheckCircle,{className:"h-4 w-4 mr-2"})," ",(0,t.jsx)("span",{children:"Mark as InComplete"})," "]}):"Mark as completed"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,t.jsxs)("div",{className:"flex-1 md:w-3/5 h-fit rounded-lg shadow-lg p-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("video",{src:D?.videoUrl,controls:!0,className:"w-full h-auto md:rounded-lg"})}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("h3",{className:"font-medium text-lg",children:`Lecture ${E?.courseDetails.lectures.findIndex(e=>e._id===D?._id)+1} : ${D?.lectureTitle}`}),!F(D?._id)&&(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{M({courseId:j,userId:w,lectureId:D._id})},children:"Mark lecture as complete"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col w-full mb-10 h-[490px] md:w-2/5 border-t md:border-t-0 md:border-l border-gray-400 md:pl-4 pt-4 md:pt-0",children:[(0,t.jsx)("h2",{className:"font-semibold text-xl mb-4 text-blue-500",children:"Course Content"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:E?.courseDetails.lectures.map(e=>(0,t.jsx)(a.Card,{className:`mb-3 hover:cursor-pointer transition transform ${e._id===D?._id?"bg-gray-200 dark:bg-gray-800":""} `,onClick:()=>{U(e)},children:(0,t.jsxs)(a.CardContent,{className:"flex items-center justify-between p-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[F(e._id)?(0,t.jsx)(o,{size:24,className:"text-green-500 mr-2"}):(0,t.jsx)(n.default,{size:24,className:"text-gray-500 mr-2"}),(0,t.jsx)("div",{children:(0,t.jsx)(a.CardTitle,{className:"text-lg font-medium",children:e.lectureTitle})})]}),F(e._id)&&(0,t.jsx)(r.Badge,{variant:"outline",className:"bg-green-200 text-green-600",children:"Completed"})]})},e._id))})]})]}),$&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-80",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Rate this course"}),(0,t.jsx)("div",{className:"flex justify-center items-center space-x-2",children:[1,2,3,4,5].map(e=>(0,t.jsx)(l.Star,{onClick:()=>q(e),className:`cursor-pointer h-8 w-8 ${T>=e?"text-yellow-500 fill-current":"text-gray-300"}`},e))}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(s.Button,{onClick:()=>B(T),className:"mt-4  w-full",children:"Submit Rating"}),(0,t.jsx)(s.Button,{onClick:()=>{P(!1),q(0)},variant:"outline",className:"mt-4 w-full",children:"Cancel"})]})]})})]}):(0,t.jsx)("p",{children:"Course not found"})}],39282)}]);