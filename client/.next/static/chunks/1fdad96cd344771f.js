(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10763,e=>{"use strict";let s=(0,e.i(43184).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>s],10763)},8906,e=>{"use strict";var s=e.i(66497),t=e.i(10977),l=e.i(10763),a=e.i(26796),r=e.i(50738);function n(){let[e,n]=(0,t.useState)([]),[i,d]=(0,t.useState)(!0),[c,o]=(0,t.useState)(),[x,m]=(0,t.useState)([]),[h,u]=(0,t.useState)(null),[p,b]=(0,t.useState)({}),[f,j]=(0,t.useState)(null),[g,N]=(0,t.useState)(""),[y,v]=(0,t.useState)(""),[w,S]=(0,t.useState)(1),[C,_]=(0,t.useState)(!1),[P,T]=(0,t.useState)({name:"",email:"",whatsappNo:"",type:""}),[k,A]=(0,t.useState)(!1);(0,t.useEffect)(()=>{A(!0),o("chat"),v("chat"),q()},[]);let q=async()=>{try{let e=await fetch("https://lms-v4tz.onrender.com/enquiry"),s=await e.json();n(s)}catch(e){console.error("Error fetching enquiries",e)}finally{d(!1)}},E=async()=>{try{let e=await fetch("https://lms-v4tz.onrender.com/live-session"),s=await e.json();m(s)}catch(e){console.error("Error fetching live sessions",e)}},L=async e=>{if(!p[e]){j(e);try{let s=await fetch(`https://lms-v4tz.onrender.com/live-session/${e}/enrolled-students`),t=await s.json();b(s=>({...s,[e]:t.students||[]}))}catch(e){console.error("Error fetching students",e)}finally{j(null)}}},M=async(e,s)=>{await fetch(`https://lms-v4tz.onrender.com/enquiry/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})}),n(t=>t.map(t=>t._id===e?{...t,status:s}:t))},z=e.filter(e=>{let s=(e.name||e.nmae||"").toLowerCase().includes(g.toLowerCase()),t=!y||e.type.toLowerCase()===y;return s&&t}),I=Math.ceil(z.length/10),$=(w-1)*10,B=z.slice($,$+10),R=(0,t.useMemo)(()=>{if(!k)return 0;let e=0;return"live"===c?x.forEach(s=>{let t=p[s._id]||[],l=Number(s.price??0);e+=t.length*l}):z.forEach(s=>{e+=Number(s.amount??0)}),e},[c,z,x,p,k]),F=e=>e&&k?Number(e).toLocaleString("en-IN",{style:"currency",currency:"INR"}):"₹0";return i||!c?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-slate-50/50 p-4 md:p-6 lg:p-8",children:[(0,s.jsxs)("div",{className:"mx-auto w-full max-w-[1600px] space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Sales Management"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"Manage your enquiries, students, and live sessions."})]}),(0,s.jsx)("div",{className:"flex items-center gap-4 bg-white px-5 py-3 rounded-xl border border-slate-200 shadow-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Total Revenue"}),(0,s.jsx)("p",{className:"text-xl font-bold text-slate-800",children:F(R.toString())})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-100 flex flex-col lg:flex-row gap-4 justify-between lg:items-center bg-white",children:[(0,s.jsx)("div",{className:"flex bg-slate-100/80 p-1 rounded-lg w-full lg:w-auto overflow-x-auto no-scrollbar",children:[{label:"Chat",value:"chat"},{label:"Counselling",value:"counselling"},{label:"Live Session",value:"live"}].map(e=>(0,s.jsx)("button",{onClick:()=>{o(e.value),S(1),"live"===e.value?E():v("all"===e.value?"":e.value)},className:`px-4 py-2 rounded-md text-sm font-medium transition-all whitespace-nowrap ${c===e.value?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-slate-200/50"}`,children:e.label},e.value))}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[(0,s.jsxs)("div",{className:"relative flex-1 sm:w-64",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search name...",value:g,onChange:e=>{N(e.target.value),S(1)},className:"w-full pl-9 pr-4 py-2 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"})]}),(0,s.jsxs)("button",{onClick:()=>_(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors shadow-sm hover:shadow",children:[(0,s.jsx)(a.Plus,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Add Enquiry"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Add"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 min-h-[400px]",children:"live"!==c?(0,s.jsx)("div",{className:"overflow-x-auto w-full",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{className:"text-xs text-slate-500 uppercase bg-slate-50/50 border-b border-slate-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Name"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Email"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"WhatsApp"}),"chat"===c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Buddy"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Pref. Call"})]}),"counselling"===c&&(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Pref. Call"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold text-right",children:"Amount"}),(0,s.jsx)("th",{className:"px-4 py-3 font-semibold text-right",children:"Created"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-100",children:B.length>0?B.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-slate-50/80 transition-colors group",children:[(0,s.jsx)("td",{className:"px-4 py-3 font-medium text-slate-900 whitespace-nowrap",children:e.name||e.nmae}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600 max-w-[200px] truncate",title:e.email,children:e.email}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:e.whatsapp}),"chat"===c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:e?.chatBuddyId?.name||"-"}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:e.preferredTimeToCall||"-"})]}),"counselling"===c&&(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600",children:e.preferredTimeToCall||"-"}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsxs)("select",{value:e.status,onChange:s=>M(e._id,s.target.value),className:`px-3 py-1 rounded-full text-xs font-semibold border-0 ring-1 ring-inset cursor-pointer focus:ring-2 focus:ring-blue-500 outline-none bg-transparent ${(e=>{switch(e){case"pending":return"bg-amber-100 text-amber-700 border-amber-200";case"inprocess":return"bg-blue-100 text-blue-700 border-blue-200";case"done":return"bg-emerald-100 text-emerald-700 border-emerald-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}})(e.status)}`,children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"inprocess",children:"In Process"}),(0,s.jsx)("option",{value:"done",children:"Done"})]})}),(0,s.jsx)("td",{className:"px-4 py-3 text-right font-medium text-slate-900 whitespace-nowrap",children:k?F(e.amount):"₹0"}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-600",children:e.createdAt?new Date(e.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"-"})]},e._id)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:10,className:"px-4 py-12 text-center text-slate-400",children:"No enquiries found matching your filters."})})})]})}):(0,s.jsx)("div",{className:"p-4 space-y-4 bg-slate-50/30 h-full",children:0===x.length?(0,s.jsx)("div",{className:"text-center py-10 text-slate-500",children:"No live sessions found"}):(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:x.map(e=>(0,s.jsxs)("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-800",children:e.title}),(0,s.jsxs)("p",{className:"text-slate-500 text-sm mt-1",children:["Price: ",(0,s.jsx)("span",{className:"font-medium text-slate-900",children:k?F(e.price?.toString()):"₹0"})]})]}),(0,s.jsx)("button",{onClick:()=>{let s=h===e._id;u(s?null:e._id),s||L(e._id)},className:`px-3 py-1 text-xs font-medium rounded-md border transition-colors ${h===e._id?"bg-slate-100 text-slate-700 border-slate-300":"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100"}`,children:h===e._id?"Close":"View Students"})]}),h===e._id&&(0,s.jsx)("div",{className:"bg-slate-50 border-t border-slate-100 max-h-[300px] overflow-y-auto p-3",children:f===e._id?(0,s.jsx)("p",{className:"text-xs text-center py-4 text-slate-500",children:"Loading..."}):p[e._id]?.length?(0,s.jsx)("div",{className:"space-y-2",children:p[e._id].map(e=>(0,s.jsx)("div",{className:"flex justify-between items-center bg-white p-2 rounded border border-slate-200 shadow-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:e.email})]})},e._id))}):(0,s.jsx)("p",{className:"text-xs text-center py-4 text-slate-500",children:"No students enrolled yet."})})]},e._id))})})}),I>1&&(0,s.jsxs)("div",{className:"p-4 border-t border-slate-100 flex justify-between items-center bg-white",children:[(0,s.jsxs)("span",{className:"text-xs text-slate-500",children:["Page ",w," of ",I]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>S(e=>Math.max(e-1,1)),disabled:1===w,className:"px-3 py-1.5 text-xs font-medium rounded border border-slate-200 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),(0,s.jsx)("button",{onClick:()=>S(e=>Math.min(e+1,I)),disabled:w===I,className:"px-3 py-1.5 text-xs font-medium rounded border border-slate-200 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})]}),C&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full relative",children:[(0,s.jsx)("button",{onClick:()=>_(!1),className:"absolute right-4 top-4 text-slate-400 hover:text-slate-600",children:(0,s.jsx)(r.X,{className:"w-5 h-5"})}),(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Add New Enquiry"}),(0,s.jsx)("div",{className:"h-32 bg-slate-100 rounded flex items-center justify-center text-slate-400",children:"Form Content Placeholder"})]})})]})}e.s(["default",()=>n])}]);